<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Apple Touch Icon pour iPhone -->
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    
    <!-- Nom de l'app sur l'√©cran d'accueil -->
    <meta name="apple-mobile-web-app-title" content="FOOD HOME">
    
    <!-- Mode plein √©cran (masquer la barre Safari) -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <!-- Couleur de la barre de statut -->
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Favicon standard pour navigateurs -->
    <link rel="icon" type="image/png" href="/apple-touch-icon.png">
    
    <title>FOOD HOME - Connexion</title>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
      
      :root {
        --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        --radius-full: 9999px;
        --radius-xl: 20px;
        --radius-2xl: 24px;
        --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
        --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: var(--font-primary);
        background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
        background-attachment: fixed;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      .login-container {
        width: 100%;
        max-width: 440px;
        animation: slideInUp 0.5s ease-out;
      }

      @keyframes slideInUp {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }

      .login-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px) saturate(180%);
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: var(--radius-2xl);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15), 0 8px 32px rgba(0, 0, 0, 0.1);
        padding: 48px 40px;
        text-align: center;
        transition: transform 0.3s ease;
      }

      .login-card:hover {
        transform: translateY(-4px);
      }

      .logo {
        width: 90px;
        height: 90px;
        margin: 0 auto 24px;
        background: var(--gradient-primary);
        border-radius: 22px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 48px;
        box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        animation: scaleIn 0.5s ease-out 0.2s both;
      }

      @keyframes scaleIn {
        from { opacity: 0; transform: scale(0.95); }
        to { opacity: 1; transform: scale(1); }
      }

      h1 {
        font-size: 32px;
        font-weight: 800;
        margin-bottom: 8px;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .subtitle {
        color: #4a5568;
        margin-bottom: 32px;
        font-size: 15px;
      }

      .pin-input-container {
        display: flex;
        gap: 12px;
        justify-content: center;
        margin-bottom: 32px;
      }

      .pin-digit {
        width: 68px;
        height: 68px;
        font-size: 32px;
        font-weight: 700;
        text-align: center;
        border: 2px solid rgba(102, 126, 234, 0.15);
        border-radius: 16px;
        background: rgba(255, 255, 255, 0.8);
        color: #1a202c;
        transition: all var(--transition-base);
      }

      .pin-digit:focus {
        outline: none;
        border-color: #667eea;
        background: white;
        box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        transform: scale(1.05);
      }

      .btn {
        width: 100%;
        padding: 16px;
        font-size: 16px;
        font-weight: 600;
        border: none;
        border-radius: var(--radius-full);
        background: var(--gradient-primary);
        color: white;
        cursor: pointer;
        transition: all var(--transition-base);
        box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);
        position: relative;
        overflow: hidden;
      }

      .btn::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        opacity: 0;
        transition: opacity var(--transition-base);
      }

      .btn:hover::before {
        opacity: 1;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 24px rgba(102, 126, 234, 0.4);
      }

      .btn > * {
        position: relative;
        z-index: 1;
      }

      .error-message {
        background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
        border: 2px solid rgba(239, 68, 68, 0.2);
        color: #dc2626;
        padding: 14px 18px;
        border-radius: 16px;
        margin-bottom: 24px;
        font-size: 14px;
        font-weight: 500;
        display: none;
        animation: slideInUp 0.3s ease-out;
      }

      .error-message.show {
        display: block;
      }

      .info-box {
        margin-top: 28px;
        padding: 18px 20px;
        background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
        border: 2px solid rgba(59, 130, 246, 0.2);
        border-radius: 16px;
        font-size: 13px;
        color: #1e40af;
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.08);
      }

      .info-box strong {
        display: block;
        margin-bottom: 6px;
        font-size: 14px;
      }

      @media (max-width: 480px) {
        .login-card { padding: 36px 28px; }
        .logo { width: 75px; height: 75px; font-size: 40px; }
        h1 { font-size: 28px; }
        .pin-digit { width: 58px; height: 58px; font-size: 28px; }
      }
    </style>
</head>
<body>
    <div class="login-container">
        <div class="login-card">
            <div class="logo">üè†</div>
            <h1>FOOD HOME</h1>
            <p class="subtitle">Bienvenue ! Entrez votre code PIN</p>
            
            <div class="error-message" id="errorMessage">
                ‚ö†Ô∏è Code PIN invalide
            </div>
            
            <form id="loginForm">
                <div class="pin-input-container">
                    <input type="text" class="pin-digit" maxlength="1" id="pin1" inputmode="numeric" pattern="[0-9]" required>
                    <input type="text" class="pin-digit" maxlength="1" id="pin2" inputmode="numeric" pattern="[0-9]" required>
                    <input type="text" class="pin-digit" maxlength="1" id="pin3" inputmode="numeric" pattern="[0-9]" required>
                    <input type="text" class="pin-digit" maxlength="1" id="pin4" inputmode="numeric" pattern="[0-9]" required>
                </div>
                
                <button type="submit" class="btn">
                    <span>üîì Se connecter</span>
                </button>
            </form>
            
            <div class="info-box">
                <strong>Code par d√©faut:</strong>
                PIN: 1234
            </div>
        </div>
    </div>
    
    <script>
      const pinInputs = document.querySelectorAll('.pin-digit');
      const form = document.getElementById('loginForm');
      const errorMessage = document.getElementById('errorMessage');
      
      // Code PIN par d√©faut (stock√© en localStorage)
      const DEFAULT_PIN = '1234';
      
      // Focus premier input
      pinInputs[0].focus();
      
      // Gestion des inputs
      pinInputs.forEach((input, index) => {
        input.addEventListener('input', (e) => {
          const value = e.target.value.replace(/[^0-9]/g, '');
          e.target.value = value;
          
          if (value && index < pinInputs.length - 1) {
            pinInputs[index + 1].focus();
          }
          
          // Auto-submit si 4 digits
          if (index === 3 && value) {
            setTimeout(() => form.requestSubmit(), 100);
          }
        });
        
        input.addEventListener('keydown', (e) => {
          if (e.key === 'Backspace' && !e.target.value && index > 0) {
            pinInputs[index - 1].focus();
          }
        });
        
        input.addEventListener('paste', (e) => {
          e.preventDefault();
          const pastedData = e.clipboardData.getData('text').replace(/[^0-9]/g, '');
          
          for (let i = 0; i < Math.min(pastedData.length, 4); i++) {
            if (pinInputs[i]) {
              pinInputs[i].value = pastedData[i];
            }
          }
          
          if (pastedData.length >= 4) {
            setTimeout(() => form.requestSubmit(), 100);
          }
        });
      });
      
      // V√©rifier le PIN
      form.addEventListener('submit', (e) => {
        e.preventDefault();
        
        const pin = Array.from(pinInputs).map(input => input.value).join('');
        
        if (pin.length !== 4) {
          showError('Veuillez entrer 4 chiffres');
          return;
        }
        
        // R√©cup√©rer le PIN sauvegard√© (ou utiliser le d√©faut)
        const savedPin = localStorage.getItem('food_home_pin') || DEFAULT_PIN;
        
        if (pin === savedPin) {
          // Sauvegarder la session
          localStorage.setItem('food_home_logged_in', 'true');
          localStorage.setItem('food_home_login_time', Date.now().toString());
          
          // Rediriger vers l'app
          window.location.href = 'home.html';
        } else {
          showError('Code PIN invalide');
        }
      });
      
      function showError(message) {
        errorMessage.textContent = '‚ö†Ô∏è ' + message;
        errorMessage.classList.add('show');
        
        // Shake animation
        pinInputs.forEach(input => {
          input.style.animation = 'shake 0.5s';
          setTimeout(() => input.style.animation = '', 500);
        });
        
        setTimeout(() => {
          errorMessage.classList.remove('show');
        }, 3000);
      }
      
      // V√©rifier si d√©j√† connect√©
      if (localStorage.getItem('food_home_logged_in') === 'true') {
        const loginTime = parseInt(localStorage.getItem('food_home_login_time') || '0');
        const now = Date.now();
        
        // Session valide 24h
        if (now - loginTime < 24 * 60 * 60 * 1000) {
          window.location.href = 'home.html';
        }
      }
    </script>
</body>
</html>
